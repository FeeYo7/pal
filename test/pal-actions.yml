test:
  - # Test Auth, input query parameter and script
    # curl -sk -H 'X-Pal-Auth: PaLLy!@#890-' 'https://127.0.0.1:8443/v1/pal/run/test/auth?input=helloworld'
    action: auth
    auth_header: X-Pal-Auth PaLLy!@#890-
    output: true
    concurrent: true
    cmd: |
      echo $INPUT

  - # Test unauthorized
    # curl -sk -H 'X-Pal-Auth: PaLLy!@#890-' 'https://127.0.0.1:8443/v1/pal/run/test/unauth'
    action: unauth
    auth_header: X-Pal-Auth PaLLy!@#890-
    output: true
    schedule: "* * * * *"
    concurrent: true
    cmd: echo helloworld

  - # Test fail cmd notification
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test/fail'
    action: fail
    concurrent: true
    output: true
    input_validate: required
    on_error:
      notification: "test/fail failed test"
    cmd: echo $INPUT && exit 1

  - # Test blocking
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test/block'
    action: block
    concurrent: false
    output: true
    cmd: sleep $INPUT || sleep 10; echo "block"

  - # Test no blocking
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test/noblock'
    action: noblock
    concurrent: true
    output: true
    cmd: echo "noblock"

  - # Test no output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test/norc'
    action: norc
    concurrent: true
    cmd: echo

  - # Test background output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test/background'
    action: background
    background: true
    concurrent: true
    cmd: echo "background"

  - # Test background output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test/background_fail'
    action: background_fail
    background: true
    concurrent: true
    response_headers:
      - header: Access-Control-Allow-Origin
        value: "*"
      - header: X-Pal
        value: Test
    cmd: echo "background_fail" && exit 1

json:
  - # Test json data
    # curl -sk -XPOST -d '{"hello":"world"}' 'https://127.0.0.1:8443/v1/pal/run/json/newres'
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/json/newres?input=%7B%22hello%22%3A%22world%22%7D'
    action: newres
    output: true
    concurrent: true
    response_headers:
      - header: Content-Type
        value: application/json
    # input_validate: required,json
    on_error:
      notification: "Failed JSON Validation"
    cmd: echo "$INPUT" | jq

test2:
  - # Test content type
    # curl -sk -o /dev/null -w '%{content_type}' 'https://127.0.0.1:8443/v1/pal/run/test2/contenttype'
    action: contenttype
    desc: Sets cache time and render of basic hello world HTML site
    output: true
    concurrent: true
    response_headers:
      - header: Cache-Control
        value: max-age=3600
      - header: Content-Type
        value: text/html
    cmd: echo '<!DOCTYPE html><html><head><title>Hello, World!</title></head><body><h1>Hello, World!</h1></body></html>'
