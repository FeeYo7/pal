test:
  - # Test Auth, input query parameter and script
    # curl -sk -H 'X-Pal-Auth: PaLLy!@#890-' 'https://127.0.0.1:8443/v1/pal/run/test?action=auth&input=helloworld'
    action: auth
    auth_header: X-Pal-Auth PaLLy!@#890-
    output: true
    concurrent: true
    cmd: |
      echo $INPUT

  - # Test unauthorized
    # curl -sk -H 'X-Pal-Auth: PaLLy!@#890-' 'https://127.0.0.1:8443/v1/pal/run/test?action=unauth'
    action: unauth
    auth_header: X-Pal-Auth PaLLy!@#890-
    output: true
    schedule: "* * * * *"
    concurrent: true
    cmd: echo helloworld

  - # Test empty cmd
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?action=emptycmd'
    action: emptycmd
    concurrent: true
    cmd: echo

  - # Test blocking
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?action=block'
    action: block
    concurrent: false
    output: true
    cmd: sleep 2 && echo "block"

  - # Test no blocking
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?action=noblock'
    action: noblock
    concurrent: true
    output: true
    cmd: echo "noblock"

  - # Test no output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?action=norc'
    action: norc
    concurrent: true
    cmd: echo

  - # Test background output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?action=background'
    action: background
    background: true
    concurrent: true
    cmd: echo "background"

  - # Test background output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?action=background_fail'
    action: background_fail
    background: true
    concurrent: true
    response_headers:
      - header: Access-Control-Allow-Origin
        value: "*"
      - header: X-Pal
        value: Test
    cmd: echo "background_fail" && exit 1

json:
  - # Test json data
    # curl -sk -XPOST -d '{"hello":"world"}' 'https://127.0.0.1:8443/v1/pal/run/json?action=newres'
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/json?action=newres&input=%7B%22hello%22%3A%22world%22%7D'
    action: newres
    output: true
    concurrent: true
    content_type: application/json
    cmd: echo "$INPUT" | jq

test2:
  - # Test content type
    # curl -sk -o /dev/null -w '%{content_type}' 'https://127.0.0.1:8443/v1/pal/run/test2?action=contenttype'
    action: contenttype
    output: true
    concurrent: true
    response_headers:
      - header: Cache-Control
        value: max-age=3600
    content_type: text/html
    cmd: echo '<!DOCTYPE html><html><head><title>Hello, World!</title></head><body><h1>Hello, World!</h1></body></html>'
