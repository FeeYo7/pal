test:
  - # Test Auth, arg query parameter and script
    # curl -sk -H 'X-Pal-Auth: PaLLy!@#890-' 'https://127.0.0.1:8443/v1/pal/run/test?target=auth&arg=helloworld'
    target: auth
    auth_header: X-Pal-Auth PaLLy!@#890-
    output: true
    concurrent: true
    cmd: |
      echo $ARG

  - # Test unauthorized
    # curl -sk -H 'X-Pal-Auth: PaLLy!@#890-' 'https://127.0.0.1:8443/v1/pal/run/test?target=unauth'
    target: unauth
    auth_header: X-Pal-Auth PaLLy!@#890-
    output: true
    schedule: "* * * * *"
    concurrent: true
    cmd: echo helloworld

  - # Test empty cmd
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?target=emptycmd'
    target: emptycmd
    concurrent: true
    cmd:

  - # Test blocking
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?target=block'
    target: block
    concurrent: false
    output: true
    cmd: sleep 2 && echo "block"

  - # Test no blocking
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?target=noblock'
    target: noblock
    concurrent: true
    output: true
    cmd: echo "noblock"

  - # Test no output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?target=norc'
    target: norc
    concurrent: true
    cmd: echo

  - # Test background output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?target=background'
    target: background
    background: true
    concurrent: true
    cmd: echo "background"

  - # Test background output
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test?target=background_fail'
    target: background_fail
    background: true
    concurrent: true
    response_headers:
      - header: Access-Control-Allow-Origin
        value: "*"
      - header: X-Pal
        value: Test
    cmd: echo "background_fail" && exit 1

json:
  - # Test json data
    # curl -sk -XPOST -d '{"hello":"world"}' 'https://127.0.0.1:8443/v1/pal/run/json?target=newres'
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/json?target=newres&arg=%7B%22hello%22%3A%22world%22%7D'
    target: newres
    output: true
    concurrent: true
    content_type: application/json
    cmd: echo "$ARG" | jq

test2:
  - # Test invalid target
    # curl -sk 'https://127.0.0.1:8443/v1/pal/run/test2?target=invalidtarget'
    target:
    cmd:
  - # Test content type
    # curl -sk -o /dev/null -w '%{content_type}' 'https://127.0.0.1:8443/v1/pal/run/test2?target=contenttype'
    target: contenttype
    output: true
    concurrent: true
    response_headers:
      - header: Cache-Control
        value: max-age=3600
    content_type: text/html
    cmd: echo '<!DOCTYPE html><html><head><title>Hello, World!</title></head><body><h1>Hello, World!</h1></body></html>'
